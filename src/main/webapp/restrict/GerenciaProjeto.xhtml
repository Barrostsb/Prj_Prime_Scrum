<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	template="/template/Layout.xhtml">


	<f:metadata>
		<f:viewAction action="#{tarefaController.buscarTodasTarefa}" />
	</f:metadata>


	<ui:define name="content">
		<p:panel id="prjHeader" header="Projeto">
			<h:outputText id="prjId"
				value="#{projetoController.projetoSelecionado.nome}" />
		</p:panel>

		<p:tabView id="tbvGerenciaDeProjeto">
			<p:tab title="Dados Projeto">

			</p:tab>


			<p:tab title="Lista de Requisitos">
			
				<p:fieldset title="Novo requisito">
				
					<h:form prependId="false" id="formTask">
						<p:growl id="msg0" />
						<h:panelGrid columns="2" cellpadding="10" styleClass="panelGrid"
							id="grid0">
							<h:outputLabel />

							<h:inputHidden id="idTarefa"
								value="#{tarefaController.tarefa.id_tarefa}" />

							<h:outputLabel for="nomeTarefa" value="Nome.:" />

							<p:inputText id="nomeTarefa" size="40"
								value="#{tarefaController.tarefa.nome}"
								onkeyup="this.value = this.value.toUpperCase()" required="true"
								requiredMessage="O Campo Nome é Obrigatório!">
							</p:inputText>

							<p:panel>
								<p:commandButton value="Salvar"
									action="#{tarefaController.salvar}"
									image="ui-icon ui-icon-disk">
								</p:commandButton>

								<p:commandButton value="Cancelar"
									actionListener="#{tarefaController.clear}"
									image="ui-icon ui-icon-close" update="@form">
								</p:commandButton>
							</p:panel>
						</h:panelGrid>
					</h:form>

				</p:fieldset>


				<p:fieldset title="Requisitos">

					<h:form id="formListaRequisitos">

						<p:dataGrid var="tarefa" value="#{tarefaController.todasTarefas}"
							columns="3" rows="12" paginator="true"
							paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
							rowsPerPageTemplate="9,12,15">

							<p:panel header="#{tarefa.nome}" style="text-align:center">
								<h:panelGrid columns="1" style="width:100%">

									<!--  <p:commandLink update=":form:carDetail"
											oncomplete="PF('carDialog').show()" title="View Detail">
											<h:outputText styleClass="ui-icon ui-icon-search"
												style="margin:0 auto;" />
											<f:setPropertyActionListener value="#{tarefa}"
												target="#{tarefaController.tarefaSelecionado}" />
										</p:commandLink>
										-->
								</h:panelGrid>
							</p:panel>

						</p:dataGrid>

						<!--  	<p:dialog header="Car Detail" widgetVar="carDialog" modal="true">
								<p:outputPanel id="carDetail" style="text-align:center;">

									<h:panelGrid columns="2" cellpadding="5">
										<h:outputLabel for="modelNo" value="Model No: " />
										<h:outputText id="modelNo"
											value="#{tarefaController.tarefaSelecionado.nome}" />

										<h:outputLabel for="year" value="Year: " />
										<h:outputText id="year" value="#{tableBean.selectedCar.year}" />

										<h:outputLabel for="color" value="Color: " />
										<h:outputText id="color"
											value="#{tableBean.selectedCar.color}"
											style="color:#{tableBean.selectedCar.color}" />
									</h:panelGrid>
								</p:outputPanel>
							</p:dialog>
-->
					</h:form>
				</p:fieldset>



			</p:tab>
			<p:tab title="Sprints">
			</p:tab>


			<p:tab title="TaskBoard">
<div id="board">
				<h:form id="taskForm">
			<h:panelGrid columns="3"  styleClass="panelGrid" id="gridMain">
					<p:fieldset id="todoColumn" legend="TO DO">
						
						<p:outputPanel id="dropAreaTodo" >
						
						<p:dataGrid id="todoGrid" var="tarefa"
							value="#{tarefaController.tarefasTodo}" columns="3" style="width:33%">

							<p:column>

								<p:panel id="pnl" header="#{tarefa.nome}"
									style="text-align:center">
								<p:draggable for="pnl" opacity="0.5" revert="true" handle=".ui-panel-titlebar" stack=".ui-panel" />
								</p:panel>
								
								
							</p:column>

						</p:dataGrid>
						
						</p:outputPanel>

					</p:fieldset>

					<p:fieldset id="inprocessColumn" legend="In Process">

						<p:outputPanel id="dropAreaInprocess">

						<p:dataGrid id="inprocessGrid" var="tarefa" value="#{tarefaController.tarefasInprocess}"
								rendered="#{not empty tarefaController.tarefasInprocess}" style="width:33%">

								<p:column>
									<p:panel id="pnl" header="#{tarefa.nome}" style="text-align:center">
									</p:panel>
								</p:column>
								
								<p:draggable for="pnl" revert="true" handle=".ui-panel-titlebar" stack=".ui-panel" />
									
								<p:droppable for="pnl" handle=".ui-panel-titlebar" stack=".ui-panel"></p:droppable>
								
							</p:dataGrid>

						</p:outputPanel>

					</p:fieldset>
					
					<p:fieldset id="doneColumn" legend="Done !">

						<p:outputPanel id="dropAreaDone" >

						<p:dataGrid id="doneGrid" var="tarefa" value="#{tarefaController.tarefasDone}"
								rendered="#{not empty tarefaController.tarefasDone}" >

								<p:column>
									<p:panel id="pnl" header="#{tarefa.nome}" style="text-align:center">
									</p:panel>
								</p:column>
								
								<p:draggable for="pnl" revert="true" handle=".ui-panel-titlebar" stack=".ui-panel" />
									
								<p:droppable for="pnl" handle=".ui-panel-titlebar" stack=".ui-panel"></p:droppable>
								
							</p:dataGrid>

						</p:outputPanel>

					</p:fieldset>

					<p:droppable for="dropAreaTodo" tolerance="touch" activeStyleClass="ui-state-highlight" datasource="dropAreaDone">
						
						<p:ajax listener="#{tarefaController.onDropTodo}" update="taskForm"  />
						
					</p:droppable>
					
					<p:droppable for="dropAreaInprocess" tolerance="touch" activeStyleClass="ui-state-highlight" datasource="todoGrid">
					
						<p:ajax listener="#{tarefaController.onDropDoing}" update="taskForm"  />
						
					</p:droppable>
					
					<p:droppable for="dropAreaDone" tolerance="touch" activeStyleClass="ui-state-highlight" datasource="todoGrid">
						
						<p:ajax listener="#{tarefaController.onDropDone}" update="taskForm"  />
						
					</p:droppable>
					</h:panelGrid>
				</h:form>
</div>

			</p:tab>
			<p:tab title="Burndown">
			</p:tab>
		</p:tabView>
	</ui:define>
</ui:composition>